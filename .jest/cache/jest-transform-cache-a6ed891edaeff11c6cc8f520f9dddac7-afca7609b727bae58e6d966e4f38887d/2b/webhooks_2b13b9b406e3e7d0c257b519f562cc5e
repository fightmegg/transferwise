aa19369a3d4c825934a0881bd9cf4913
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.constructEvent = void 0;

var _crypto = _interopRequireDefault(require("crypto"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const livePublicKey = `
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvO8vXV+JksBzZAY6GhSO
XdoTCfhXaaiZ+qAbtaDBiu2AGkGVpmEygFmWP4Li9m5+Ni85BhVvZOodM9epgW3F
bA5Q1SexvAF1PPjX4JpMstak/QhAgl1qMSqEevL8cmUeTgcMuVWCJmlge9h7B1CS
D4rtlimGZozG39rUBDg6Qt2K+P4wBfLblL0k4C4YUdLnpGYEDIth+i8XsRpFlogx
CAFyH9+knYsDbR43UJ9shtc42Ybd40Afihj8KnYKXzchyQ42aC8aZ/h5hyZ28yVy
Oj3Vos0VdBIs/gAyJ/4yyQFCXYte64I7ssrlbGRaco4nKF3HmaNhxwyKyJafz19e
HwIDAQAB
-----END PUBLIC KEY-----`;
const sandboxPublicKey = `
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwpb91cEYuyJNQepZAVfP
ZIlPZfNUefH+n6w9SW3fykqKu938cR7WadQv87oF2VuT+fDt7kqeRziTmPSUhqPU
ys/V2Q1rlfJuXbE+Gga37t7zwd0egQ+KyOEHQOpcTwKmtZ81ieGHynAQzsn1We3j
wt760MsCPJ7GMT141ByQM+yW1Bx+4SG3IGjXWyqOWrcXsxAvIXkpUD/jK/L958Cg
nZEgz0BSEh0QxYLITnW1lLokSx/dTianWPFEhMC9BgijempgNXHNfcVirg1lPSyg
z7KqoKUN0oHqWLr2U1A+7kqrl6O2nx3CKs1bj1hToT1+p4kcMoHXA7kA+VBLUpEs
VwIDAQAB
-----END PUBLIC KEY-----`;

const constructEvent = (sandbox = false, payload, signature) => {
  const sig = _crypto.default.createVerify("RSA-SHA1");

  sig.update(payload);
  const verified = sig.verify(sandbox ? sandboxPublicKey : livePublicKey, signature, "base64");
  if (verified) return JSON.parse(payload);
  return null;
};

exports.constructEvent = constructEvent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYmhvb2tzLmpzIl0sIm5hbWVzIjpbImxpdmVQdWJsaWNLZXkiLCJzYW5kYm94UHVibGljS2V5IiwiY29uc3RydWN0RXZlbnQiLCJzYW5kYm94IiwicGF5bG9hZCIsInNpZ25hdHVyZSIsInNpZyIsImNyeXB0byIsImNyZWF0ZVZlcmlmeSIsInVwZGF0ZSIsInZlcmlmaWVkIiwidmVyaWZ5IiwiSlNPTiIsInBhcnNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFFQSxNQUFNQSxhQUFhLEdBQUk7Ozs7Ozs7Ozt5QkFBdkI7QUFXQSxNQUFNQyxnQkFBZ0IsR0FBSTs7Ozs7Ozs7O3lCQUExQjs7QUFXTyxNQUFNQyxjQUFjLEdBQUcsQ0FBQ0MsT0FBTyxHQUFHLEtBQVgsRUFBa0JDLE9BQWxCLEVBQTJCQyxTQUEzQixLQUF5QztBQUNyRSxRQUFNQyxHQUFHLEdBQUdDLGdCQUFPQyxZQUFQLENBQW9CLFVBQXBCLENBQVo7O0FBQ0FGLEVBQUFBLEdBQUcsQ0FBQ0csTUFBSixDQUFXTCxPQUFYO0FBQ0EsUUFBTU0sUUFBUSxHQUFHSixHQUFHLENBQUNLLE1BQUosQ0FDZlIsT0FBTyxHQUFHRixnQkFBSCxHQUFzQkQsYUFEZCxFQUVmSyxTQUZlLEVBR2YsUUFIZSxDQUFqQjtBQUtBLE1BQUlLLFFBQUosRUFBYyxPQUFPRSxJQUFJLENBQUNDLEtBQUwsQ0FBV1QsT0FBWCxDQUFQO0FBQ2QsU0FBTyxJQUFQO0FBQ0QsQ0FWTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuXG5jb25zdCBsaXZlUHVibGljS2V5ID0gYFxuLS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS1cbk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdk84dlhWK0prc0J6WkFZNkdoU09cblhkb1RDZmhYYWFpWitxQWJ0YURCaXUyQUdrR1ZwbUV5Z0ZtV1A0TGk5bTUrTmk4NUJoVnZaT29kTTllcGdXM0ZcbmJBNVExU2V4dkFGMVBQalg0SnBNc3Rhay9RaEFnbDFxTVNxRWV2TDhjbVVlVGdjTXVWV0NKbWxnZTloN0IxQ1NcbkQ0cnRsaW1HWm96RzM5clVCRGc2UXQySytQNHdCZkxibEwwazRDNFlVZExucEdZRURJdGgraThYc1JwRmxvZ3hcbkNBRnlIOStrbllzRGJSNDNVSjlzaHRjNDJZYmQ0MEFmaWhqOEtuWUtYemNoeVE0MmFDOGFaL2g1aHlaMjh5Vnlcbk9qM1ZvczBWZEJJcy9nQXlKLzR5eVFGQ1hZdGU2NEk3c3NybGJHUmFjbzRuS0YzSG1hTmh4d3lLeUphZnoxOWVcbkh3SURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1gO1xuXG5jb25zdCBzYW5kYm94UHVibGljS2V5ID0gYFxuLS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS1cbk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBd3BiOTFjRVl1eUpOUWVwWkFWZlBcblpJbFBaZk5VZWZIK242dzlTVzNmeWtxS3U5MzhjUjdXYWRRdjg3b0YyVnVUK2ZEdDdrcWVSemlUbVBTVWhxUFVcbnlzL1YyUTFybGZKdVhiRStHZ2EzN3Q3endkMGVnUStLeU9FSFFPcGNUd0ttdFo4MWllR0h5bkFRenNuMVdlM2pcbnd0NzYwTXNDUEo3R01UMTQxQnlRTSt5VzFCeCs0U0czSUdqWFd5cU9XcmNYc3hBdklYa3BVRC9qSy9MOTU4Q2dcbm5aRWd6MEJTRWgwUXhZTElUblcxbExva1N4L2RUaWFuV1BGRWhNQzlCZ2lqZW1wZ05YSE5mY1ZpcmcxbFBTeWdcbno3S3FvS1VOMG9IcVdMcjJVMUErN2txcmw2TzJueDNDS3MxYmoxaFRvVDErcDRrY01vSFhBN2tBK1ZCTFVwRXNcblZ3SURBUUFCXG4tLS0tLUVORCBQVUJMSUMgS0VZLS0tLS1gO1xuXG5leHBvcnQgY29uc3QgY29uc3RydWN0RXZlbnQgPSAoc2FuZGJveCA9IGZhbHNlLCBwYXlsb2FkLCBzaWduYXR1cmUpID0+IHtcbiAgY29uc3Qgc2lnID0gY3J5cHRvLmNyZWF0ZVZlcmlmeShcIlJTQS1TSEExXCIpO1xuICBzaWcudXBkYXRlKHBheWxvYWQpO1xuICBjb25zdCB2ZXJpZmllZCA9IHNpZy52ZXJpZnkoXG4gICAgc2FuZGJveCA/IHNhbmRib3hQdWJsaWNLZXkgOiBsaXZlUHVibGljS2V5LFxuICAgIHNpZ25hdHVyZSxcbiAgICBcImJhc2U2NFwiXG4gICk7XG4gIGlmICh2ZXJpZmllZCkgcmV0dXJuIEpTT04ucGFyc2UocGF5bG9hZCk7XG4gIHJldHVybiBudWxsO1xufTtcbiJdfQ==